<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <script type="text/javascript">/*<![CDATA[*/
  /*
  March 19, 2004 MathHTML (c) Peter Jipsen http://www.chapman.edu/~jipsen
  Released under the GNU General Public License version 2 or later.
  See the GNU General Public License (at http://www.gnu.org/copyleft/gpl.html)
  for more details.
  */
  
  function convertMath(node) {// for Gecko
    if (node.nodeType==1) {
      var newnode =
        document.createElementNS("http://www.w3.org/1998/Math/MathML",
          node.nodeName.toLowerCase());
      for(var i=0; i < node.attributes.length; i++)
        newnode.setAttribute(node.attributes[i].nodeName,
          node.attributes[i].value);
      for (var i=0; i<node.childNodes.length; i++) {
        var st = node.childNodes[i].nodeValue;
        if (st==null || st.slice(0,1)!=" " && st.slice(0,1)!="\n")
          newnode.appendChild(convertMath(node.childNodes[i]));
      }
      return newnode;
    }
    else return node;
  }
  
  function convert() {
    var mmlnode = document.getElementsByTagName("math");
    var st,str,node,newnode;
    for (var i=0; i<mmlnode.length; i++)
      if (document.createElementNS!=null)
        mmlnode[i].parentNode.replaceChild(convertMath(mmlnode[i]),mmlnode[i]);
      else { // convert for IE
        str = "";
        node = mmlnode[i];
        while (node.nodeName!="/MATH") {
          st = node.nodeName.toLowerCase();
          if (st=="#text") str += node.nodeValue;
          else {
            str += (st.slice(0,1)=="/" ? "</m:"+st.slice(1) : "<m:"+st);
            if (st.slice(0,1)!="/")
               for(var j=0; j < node.attributes.length; j++)
                 if (node.attributes[j].value!="italic" &&
                   node.attributes[j].value!="" &&
                   node.attributes[j].value!="inherit" &&
                   node.attributes[j].value!=undefined)
                   str += " "+node.attributes[j].nodeName+"="+
                       "\""+node.attributes[j].value+"\"";
            str += ">";
          }
          node = node.nextSibling;
          node.parentNode.removeChild(node.previousSibling);
        }
        str += "</m:math>";
        newnode = document.createElement("span");
        node.parentNode.replaceChild(newnode,node);
        newnode.innerHTML = str;
      }
  }
  
  if (document.createElementNS==null) {
    document.write("<object id=\"mathplayer\"\
    classid=\"clsid:32F66A20-7614-11D4-BD11-00104BD3F987\"></object>");
    document.write("<?import namespace=\"m\" implementation=\"#mathplayer\"?>");
  }
  if(typeof window.addEventListener != 'undefined'){
    window.addEventListener('load', convert, false);
  }
  if(typeof window.attachEvent != 'undefined') {
    window.attachEvent('onload', convert);
  }
  /*]]>*/
  </script>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#installation"><span class="toc-section-number">2</span> Installation</a><ul>
<li><a href="#installing-bali-phy"><span class="toc-section-number">2.1</span> Installing BAli-Phy</a></li>
<li><a href="#installing-additional-software"><span class="toc-section-number">2.2</span> Installing additional software</a></li>
<li><a href="#installing-bes"><span class="toc-section-number">2.3</span> Installing BES</a></li>
</ul></li>
<li><a href="#running-the-program"><span class="toc-section-number">3</span> Running the program</a><ul>
<li><a href="#quick-start"><span class="toc-section-number">3.1</span> Quick Start</a></li>
</ul></li>
<li><a href="#input"><span class="toc-section-number">4</span> Input</a></li>
<li><a href="#output"><span class="toc-section-number">5</span> Output</a><ul>
<li><a href="#output-directory"><span class="toc-section-number">5.1</span> Output directory</a></li>
<li><a href="#output-files"><span class="toc-section-number">5.2</span> Output files</a></li>
</ul></li>
<li><a href="#analyzing-output-files"><span class="toc-section-number">6</span> Analyzing output files</a><ul>
<li><a href="#using-statreport"><span class="toc-section-number">6.1</span> Using <code>statreport</code></a></li>
<li><a href="#using-tracer"><span class="toc-section-number">6.2</span> Using <code>tracer</code></a></li>
</ul></li>
<li><a href="#mating-system-models"><span class="toc-section-number">7</span> Mating system models</a><ul>
<li><a href="#generic-model"><span class="toc-section-number">7.1</span> Generic model</a></li>
<li><a href="#pure-hermaphrodite"><span class="toc-section-number">7.2</span> Pure Hermaphrodite</a><ul>
<li><a href="#variant-i"><span class="toc-section-number">7.2.1</span> Variant I</a></li>
<li><a href="#variant-ii"><span class="toc-section-number">7.2.2</span> Variant II</a></li>
</ul></li>
<li><a href="#androdioecy"><span class="toc-section-number">7.3</span> Androdioecy</a><ul>
<li><a href="#variant-i-1"><span class="toc-section-number">7.3.1</span> Variant I</a></li>
<li><a href="#variant-ii-1"><span class="toc-section-number">7.3.2</span> Variant II</a></li>
</ul></li>
<li><a href="#gynodioecy"><span class="toc-section-number">7.4</span> Gynodioecy</a></li>
</ul></li>
<li><a href="#specifying-additional-information"><span class="toc-section-number">8</span> Specifying additional information</a><ul>
<li><a href="#introduce-a-variable-with-a-prior-and-place-observations-on-it."><span class="toc-section-number">8.1</span> Introduce a variable with a prior and place observations on it.</a></li>
<li><a href="#fix-a-variable-to-a-known-constant-value."><span class="toc-section-number">8.2</span> Fix a variable to a known constant value.</a></li>
<li><a href="#place-a-subjective-prior-on-a-variable"><span class="toc-section-number">8.3</span> Place a subjective prior on a variable</a></li>
</ul></li>
<li><a href="#bayesian-priors-and-posteriors"><span class="toc-section-number">9</span> Bayesian priors and posteriors</a><ul>
<li><a href="#uninformative-priors"><span class="toc-section-number">9.1</span> Uninformative priors</a></li>
<li><a href="#comparing-the-posterior-and-the-prior"><span class="toc-section-number">9.2</span> Comparing the posterior and the prior</a></li>
<li><a href="#priors-on-composite-parameters"><span class="toc-section-number">9.3</span> Priors on composite parameters</a></li>
</ul></li>
<li><a href="#tasks"><span class="toc-section-number">10</span> Tasks</a></li>
</ul>
</div>
<h1 id="introduction"><span class="header-section-number">1</span> Introduction</h1>
<p>BES is a software package for estimating self-fertilization (selfing) rates and other mating system parameters from genotype data. BES estimates parameters in a Bayesian framework using Markov chain Monte Carlo (MCMC). BES contains models of pure hermaphroditism, androdioecy (hermaphrodites + males), and gynodioecy (hermaphrodites + females). Under each model, BES estimates selfing rates, mutation rates, and mating-system specific parameters. BES also contains a generic model for estimating selfing rates and mutation rates independent of a mating system. Additional non-genetic information, such as field observations of the number of females or males, is required for estimating parameters under the gynodioecious model and the androdioecious model.</p>
<p>BES is run as a Unix command line program. It is not a GUI program; instead you must run it in a terminal. Therefore, you might want to keep a <a href="http://www.ee.surrey.ac.uk/Teaching/Unix">Unix Tutorial</a> or <a href="http://www.rain.org/~mkummel/unix.html">Unix cheat sheet</a> handy while you work.</p>
<p>BES runs on Linux, Mac OS X, and Windows. BES is distributed as an extension package for the BAli-Phy inference framework. You might therefore wish to refer to the <a href="http://www.bali-phy.org/README.html">BAli-Phy Documentation</a> as well.</p>
<p>BES contains a number of modules that correspond to different mating system models. Each model allows estimating a different set of parameters. The generic model and the pure hermaphrodite model without inbreeding depression can be run without modification to estimate the selfing rate and locus-specific mutation rates.</p>
<p>However, the gynodioecious model and the androdiecious model require additional information besides the genetic data, such as (for example) field observations on the fraction of hermaphrodites. Therefore, the user must edit these modules to add this information before attempting to run these models. This manual describes how to add information, but is not a substitute for understanding something about the structure of the model.</p>
<h1 id="installation"><span class="header-section-number">2</span> Installation</h1>
<h2 id="installing-bali-phy"><span class="header-section-number">2.1</span> Installing BAli-Phy</h2>
<p>Since BES is an extension package for BALi-Phy, you must first install BAli-Phy before you can use BES. To install BAli-Phy, follow the <a href="http://www.bali-phy.org/README.html#installation">installation instructions for BAli-Phy</a>.</p>
<h2 id="installing-additional-software"><span class="header-section-number">2.2</span> Installing additional software</h2>
<p>You should also install the following software:</p>
<ul>
<li><a href="http://tree.bio.ed.ac.uk/software/tracer/">Tracer</a> helps to visualize the results of MCMC runs.</li>
</ul>
<h2 id="installing-bes"><span class="header-section-number">2.3</span> Installing BES</h2>
<p>First, check that the <code>bali-phy-pkg</code> command works:</p>
<pre><code>% bali-phy-pkg help</code></pre>
<p>Download and install the BES package:</p>
<pre><code>% bali-phy-pkg install BES</code></pre>
<p>Check that the package is installed:</p>
<pre><code>% bali-phy-pkg packages</code></pre>
<p>To see what modules were installed, run:</p>
<pre><code>% bali-phy-pkg files BES</code></pre>
<p>You can uninstall the package by running:</p>
<pre><code>% bali-phy-pkg uninstall BES</code></pre>
<p>Next, download some additional modules for particular mating systems. These files are not installed into the package directory because they must be manually modified before they are used.</p>
<ul>
<li><a href="https://raw.githubusercontent.com/bredelings/BayesianEstimatorSelfing/master/HermID.hs">HermID.hs</a></li>
<li><a href="https://raw.githubusercontent.com/bredelings/BayesianEstimatorSelfing/master/Andro.hs">Andro.hs</a></li>
<li><a href="https://raw.githubusercontent.com/bredelings/BayesianEstimatorSelfing/master/AndroID.hs">AndroID.hs</a></li>
<li><a href="https://raw.githubusercontent.com/bredelings/BayesianEstimatorSelfing/master/Gyno.hs">Gyno.hs</a></li>
</ul>
<p>Keep in mind that only the generic model and the pure hermaphrodite model without inbreeding depression can be used to run an analysis without any modification.</p>
<h1 id="running-the-program"><span class="header-section-number">3</span> Running the program</h1>
<h2 id="quick-start"><span class="header-section-number">3.1</span> Quick Start</h2>
<p>First, check that the model loads correctly:</p>
<pre><code>% bali-phy -M PopGen.Selfing.Generic --test --- Examples/outfile.001.70.001.phase</code></pre>
<p>If that works, then run the MCMC using the generic model:</p>
<pre><code>% bali-phy -M PopGen.Selfing.Generic --iter=1000 --- Examples/outfile.001.70.001.phase &amp;</code></pre>
<p>This should create a directory called <code>Generic-1/</code> (or <code>Generic-2/</code>, etc.) that contains the output files.</p>
<p>Second, load the output file <code>Generic-1/C1.p</code> using the GUI program Tracer. On Unix, you can run this from the command line as follows:</p>
<pre><code>% tracer Selfing-1/C1.p &amp;</code></pre>
<p>It is also possible to use a non-graphical program statreport to view the estimates of the selfing rate</p>
<pre><code>% statreport --select=&quot;Selfing.s*&quot; Selfing-1/C1.p</code></pre>
<p>This can be useful when analyzing data in a terminal.</p>
<h1 id="input"><span class="header-section-number">4</span> Input</h1>
<p>Input files must be in PHASE format. Both alleles for each locus should be specified, with NA given to indicate missing data.</p>
<p>A PHASE file contains a 3-line header, followed by a single line for each observed individual. The header consists of</p>
<ol style="list-style-type: decimal">
<li>The number of individuals, on a line by itself.</li>
<li>The number of loci, on a line by itself.</li>
<li>A sequence of 'M's (for microsatellite) on a line by itself. The number of M's should equal the number of loci.</li>
</ol>
<p>The line describing each individual should contain an individual name, followed by a list of integer allele names. The name and the numbers should be tab-delimited, and there should be twice the number of alleles as loci, since there are 2 alleles per locus. Integer allele names must be positive. The purpose of this is to avoid confusion, since 0 and negative numbers are often used to indicate missing data.</p>
<p>Here is a very small PHASE file as an illustration:</p>
<pre><code>2
3
MMM
sample.1    23  23  2   1   NA  NA
sample.2    23  20  1   1   4   5</code></pre>
<h1 id="output"><span class="header-section-number">5</span> Output</h1>
<h2 id="output-directory"><span class="header-section-number">5.1</span> Output directory</h2>
<p>BAli-Phy creates a new directory to store its output files each time it is run. By default, the directory name is the name of the model file, with a number added to the end to make it unique. BAli-Phy first checks if there is already a directory called <em>file</em>-1/, and then moves on to <em>file</em>-2/, etc. until it find an unused directory name.</p>
<p>You can specify a different name to use instead of the model file name by using the <code>--name</code> option.</p>
<h2 id="output-files"><span class="header-section-number">5.2</span> Output files</h2>
<p>BAli-Phy writes the following output files inside the directory that it creates:</p>
<table>
<thead>
<tr class="header">
<th align="left">File name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">C1.out</td>
<td align="left">General information: command line, start time, etc.</td>
</tr>
<tr class="even">
<td align="left">C1.err</td>
<td align="left">May contain error messages.</td>
</tr>
<tr class="odd">
<td align="left">C1.p</td>
<td align="left">MCMC samples for different variables.</td>
</tr>
</tbody>
</table>
<p>The <code>C1.p</code> file contains MCMC samples for the variables that are being estimated. For example, the variable <code>Selfing.s*</code> indicates the fraction of uniparental individuals at the time of breeding.</p>
<p>Since each mating system has a unique set of parameters, the variables for each model will be described in the section for that model.</p>
<h1 id="analyzing-output-files"><span class="header-section-number">6</span> Analyzing output files</h1>
<h2 id="using-statreport"><span class="header-section-number">6.1</span> Using <code>statreport</code></h2>
<p>In order to determine estimates of parameters, you can use the program <code>statreport</code>:</p>
<pre><code>% statreport C1.p</code></pre>
<p>You can plot the posterior distribution for specific parameters by using the select option:</p>
<pre><code>% statreport --select &quot;Selfing.s*&quot; C1.p</code></pre>
<p>Here quotes are necessary to make sure that the <code>*</code> is not interpreted by the command line shell, but is passed in to the <code>statreport</code> program unchanged.</p>
<p>You can also use the arguments <code>--mean</code>, <code>--mode</code>, and <code>--median</code> (the default) to exime different properties of the posterior distribution.</p>
<h2 id="using-tracer"><span class="header-section-number">6.2</span> Using <code>tracer</code></h2>
<p>Tracer is a graphical program for exploring posterior distributions.</p>
<p>Load the <code>C1.p</code> file using <code>tracer</code>. On Unix, if <code>tracer</code> is in your <code>PATH</code>, you can do this by typing</p>
<pre><code>tracer C1.p &amp;</code></pre>
<h1 id="mating-system-models"><span class="header-section-number">7</span> Mating system models</h1>
<p>The stochastic process that generates the genetic data is described in terms of mating system parameters <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>Ψ</mo><annotation encoding="application/x-tex">\Psi</annotation></semantics></math> and the effective scaled mutation rates <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">\Theta^*_l</annotation></semantics></math> for each locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>. The set of variables <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>Ψ</mo><annotation encoding="application/x-tex">\Psi</annotation></semantics></math> is specific for each mating system.</p>
<p>Some quantites are of interest for each mating system</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> is the fraction of uniparental adults (selfing rate).</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><msub><mi>lim</mi><mrow><mi>N</mi><mo accent="false">→</mo><mo>∞</mo></mrow></msub><mfrac><msup><mi>N</mi><mo>*</mo></msup><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex">R = \lim_{N\to\infty} \frac{N^*}{N}</annotation></semantics></math> is the decrease in effective population size, as determined by the rate of parent-sharing.</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>k</mi></msub><annotation encoding="application/x-tex">{T_k}</annotation></semantics></math> is the number of generations of selfing in the immediate ancestry of individual <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>Θ</mo><mi>l</mi></msub><annotation encoding="application/x-tex">{\Theta_l}</annotation></semantics></math> is the scaled mutation rate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mi>N</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">4Nu</annotation></semantics></math> for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">{\Theta^*_l}</annotation></semantics></math> is the <em>effective</em> scaled mutation rate for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</li>
</ul>
<p>Here, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math> is the population size, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>N</mi><mo>*</mo></msup><annotation encoding="application/x-tex">N^*</annotation></semantics></math> is the effective population size. The effective scaled mutation rate is</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><mo>=</mo><msub><mo>Θ</mo><mi>l</mi></msub><mo>⋅</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>s</mi><mo>*</mo></msup><mo>/</mo><mn>2</mn><mo stretchy="false" form="postfix">)</mo><mo>/</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">\Theta^*_l = \Theta_l \cdot (1-s^*/2) / R</annotation></semantics></math>.</li>
</ul>
<p>In general, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math> are composite parameters: they are determined from the basic mating system parameters <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>Ψ</mo><annotation encoding="application/x-tex">\Psi</annotation></semantics></math>.</p>
<p>It is important to note that the genetic data contain information directly only about <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">{\Theta^*_l}</annotation></semantics></math>. Therefore, the basic mating system parameters <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>Ψ</mo><annotation encoding="application/x-tex">\Psi</annotation></semantics></math> may be unidentifiable on the basis of genetic data alone. This can be solved by introducing additional data in the form on field observations on, for example, the fraction of males or the fraction of females in the population. When such information is unavailable, the generic model should be used.</p>
<h2 id="generic-model"><span class="header-section-number">7.1</span> Generic model</h2>
<p>The generic model is agnostic about the particular mating system, and simply reports <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>k</mi></msub><annotation encoding="application/x-tex">{T_k}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">{\Theta^*_l}</annotation></semantics></math> as estimated from the genetic data. Since the mating system is not known, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math> cannot be calculated. This means that it is not possible to calculate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>Θ</mo><mi>l</mi></msub><annotation encoding="application/x-tex">{\Theta_l}</annotation></semantics></math> from <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">{\Theta^*_l}</annotation></semantics></math>.</p>
<p>The generic model characterizes the mating system simply in terms of the selfing rate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math>. Thus, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Ψ</mo><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msup><mi>s</mi><mo>*</mo></msup><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Psi=\{s^*\}</annotation></semantics></math>, and so <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> is a basic parameter, instead of being calculated from other parameters.</p>
<p>The following variables are estimated, with the field names given:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math></td>
<td align="left">Selfing.s*</td>
<td align="left">Fraction of uniparental adults (selfing rate).</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>k</mi></msub><annotation encoding="application/x-tex">{T_k}</annotation></semantics></math></td>
<td align="left">Selfing.DiploidAFS.t!!k</td>
<td align="left">Number of generations of selfing for individual <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">{\Theta^*_l}</annotation></semantics></math></td>
<td align="left">Selfing.Theta*!!l</td>
<td align="left"><em>Effective</em> scaled mutation rate for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</td>
</tr>
</tbody>
</table>
<p>This variant is run by specifying <code>-M PopGen.Selfing.Generic</code> on the command line.</p>
<h2 id="pure-hermaphrodite"><span class="header-section-number">7.2</span> Pure Hermaphrodite</h2>
<p>In the pure hermaphrodite model, each individual contributes both male and female gametes to the gene pool. There are two variants of this model.</p>
<h3 id="variant-i"><span class="header-section-number">7.2.1</span> Variant I</h3>
<p>The first variant has <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Ψ</mo><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msup><mi>s</mi><mo>*</mo></msup><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Psi=\{s^*\}</annotation></semantics></math>. This variant treats <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> as a basic parameter, and does not model inbreeding depression. This variant is similar to the generic model, except that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math> can be calculated because the mating system is known to be a pure hermaphrodite mating system. This allows <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>Θ</mo><mi>l</mi></msub><annotation encoding="application/x-tex">{\Theta_l}</annotation></semantics></math> to be calculated also. However, note that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math> is always <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math> for the pure hermaphrodite model.</p>
<p>The following variables are estimated, with the field names given:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math></td>
<td align="left">Selfing.s*</td>
<td align="left">Fraction of uniparental adults (selfing rate).</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>k</mi></msub><annotation encoding="application/x-tex">{T_k}</annotation></semantics></math></td>
<td align="left">Selfing.DiploidAFS.t!!k</td>
<td align="left">Number of generations of selfing for individual <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math></td>
<td align="left">Selfing.R</td>
<td align="left">Decrease in parent-sharing effective population size</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">{\Theta^*_l}</annotation></semantics></math></td>
<td align="left">Selfing.Theta*!!l</td>
<td align="left"><em>Effective</em> scaled mutation rate for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>Θ</mo><mi>l</mi></msub><annotation encoding="application/x-tex">{\Theta_l}</annotation></semantics></math></td>
<td align="left">Selfing.Theta!!l</td>
<td align="left">Scaled mutation rate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mi>N</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">4Nu</annotation></semantics></math> for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</td>
</tr>
</tbody>
</table>
<p>This variant is run by specifying <code>-M PopGen.Selfing.Herm</code> on the command line.</p>
<h3 id="variant-ii"><span class="header-section-number">7.2.2</span> Variant II</h3>
<p>The second variant has <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Ψ</mo><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mover><mi>s</mi><mo accent="true">̃</mo></mover><mo>,</mo><mi>τ</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Psi=\{\tilde{s},\tau\}</annotation></semantics></math>. This variant treats <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> as a composite parameter.</p>
<p>The following variables are estimated, with the field names given:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>s</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{s}</annotation></semantics></math></td>
<td align="left">Selfing.s~</td>
<td align="left">Fraction of uniparental seeds.</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math></td>
<td align="left">Selfing.tau</td>
<td align="left">Relative viability of selfed seeds.</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math></td>
<td align="left">Selfing.s*</td>
<td align="left">Fraction of uniparental adults (selfing rate).</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>k</mi></msub><annotation encoding="application/x-tex">{T_k}</annotation></semantics></math></td>
<td align="left">Selfing.DiploidAFS.t!!k</td>
<td align="left">Number of generations of selfing for individual <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math></td>
<td align="left">Selfing.R</td>
<td align="left">Decrease in parent-sharing effective population size</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">{\Theta^*_l}</annotation></semantics></math></td>
<td align="left">Selfing.Theta*!!l</td>
<td align="left"><em>Effective</em> scaled mutation rate for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>Θ</mo><mi>l</mi></msub><annotation encoding="application/x-tex">{\Theta_l}</annotation></semantics></math></td>
<td align="left">Selfing.Theta!!l</td>
<td align="left">Scaled mutation rate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mi>N</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">4Nu</annotation></semantics></math> for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</td>
</tr>
</tbody>
</table>
<p>Here the user must modify <code>HermID.hs</code> to add additional information about <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>s</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{s}</annotation></semantics></math> or <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>.</p>
<p>This variant is run by specifying <code>-m HermID.hs</code> on the command line.</p>
<h2 id="androdioecy"><span class="header-section-number">7.3</span> Androdioecy</h2>
<p>In the androdioecious model, the population consist of some fraction <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>m</mi></msub><annotation encoding="application/x-tex">p_m</annotation></semantics></math> of males, with the rest of the individuals being hermaphrodites. Hermaphrodites produce males gametes, but only fertilize their own eggs. There are two variants of this model.</p>
<h3 id="variant-i-1"><span class="header-section-number">7.3.1</span> Variant I</h3>
<p>The first variant has <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Ψ</mo><mo>=</mo><mo stretchy="false" form="prefix">{</mo><msup><mi>s</mi><mo>*</mo></msup><mo>,</mo><msub><mi>p</mi><mi>m</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Psi=\{s^*,p_m\}</annotation></semantics></math>. This variant treats <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> as a basic parameter, and does not model inbreeding depression.</p>
<p>The following variables are estimated, with the field names given:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math></td>
<td align="left">Selfing.s*</td>
<td align="left">Fraction of uniparental adults (selfing rate).</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>m</mi></msub><annotation encoding="application/x-tex">p_m</annotation></semantics></math></td>
<td align="left">Selfing.p_m</td>
<td align="left">The fraction of males</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>k</mi></msub><annotation encoding="application/x-tex">{T_k}</annotation></semantics></math></td>
<td align="left">Selfing.DiploidAFS.t!!k</td>
<td align="left">Number of generations of selfing for individual <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math></td>
<td align="left">Selfing.R</td>
<td align="left">Decrease in parent-sharing effective population size</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">{\Theta^*_l}</annotation></semantics></math></td>
<td align="left">Selfing.Theta*!!l</td>
<td align="left"><em>Effective</em> scaled mutation rate for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>Θ</mo><mi>l</mi></msub><annotation encoding="application/x-tex">{\Theta_l}</annotation></semantics></math></td>
<td align="left">Selfing.Theta!!l</td>
<td align="left">Scaled mutation rate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mi>N</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">4Nu</annotation></semantics></math> for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</td>
</tr>
</tbody>
</table>
<p>Here the user must modify <code>Andro.hs</code> to add additional information about <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>m</mi></msub><annotation encoding="application/x-tex">p_m</annotation></semantics></math>.</p>
<p>This variant is run by specifying <code>-m Andro.hs</code> on the command line.</p>
<h3 id="variant-ii-1"><span class="header-section-number">7.3.2</span> Variant II</h3>
<p>The second variant has <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Ψ</mo><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mover><mi>s</mi><mo accent="true">̃</mo></mover><mo>,</mo><mi>τ</mi><mo>,</mo><msub><mi>p</mi><mi>m</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Psi=\{\tilde{s},\tau,p_m\}</annotation></semantics></math>. This variant treats <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> as a composite parameter.</p>
<p>The following variables are estimated, with the field names given:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>s</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{s}</annotation></semantics></math></td>
<td align="left">Selfing.s~</td>
<td align="left">Fraction of uniparental zygotes.</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math></td>
<td align="left">Selfing.tau</td>
<td align="left">Relative viability of selfed zygotes.</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>m</mi></msub><annotation encoding="application/x-tex">p_m</annotation></semantics></math></td>
<td align="left">Selfing.p_m</td>
<td align="left">The fraction of males</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math></td>
<td align="left">Selfing.s*</td>
<td align="left">Fraction of uniparental adults (selfing rate).</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>k</mi></msub><annotation encoding="application/x-tex">{T_k}</annotation></semantics></math></td>
<td align="left">Selfing.DiploidAFS.t!!k</td>
<td align="left">Number of generations of selfing for individual <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math></td>
<td align="left">Selfing.R</td>
<td align="left">Decrease in parent-sharing effective population size</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">{\Theta^*_l}</annotation></semantics></math></td>
<td align="left">Selfing.Theta*!!l</td>
<td align="left"><em>Effective</em> scaled mutation rate for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>Θ</mo><mi>l</mi></msub><annotation encoding="application/x-tex">{\Theta_l}</annotation></semantics></math></td>
<td align="left">Selfing.Theta!!l</td>
<td align="left">Scaled mutation rate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mi>N</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">4Nu</annotation></semantics></math> for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</td>
</tr>
</tbody>
</table>
<p>Here the user must modify <code>AndroID.hs</code> to add additional information about <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>m</mi></msub><annotation encoding="application/x-tex">p_m</annotation></semantics></math> and also about <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>s</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{s}</annotation></semantics></math> or <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>.</p>
<p>This variant is run by specifying <code>-m AndroID.hs</code> on the command line.</p>
<h2 id="gynodioecy"><span class="header-section-number">7.4</span> Gynodioecy</h2>
<p>In the gynodioecious model, the population consist of some fraction <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>f</mi></msub><annotation encoding="application/x-tex">p_f</annotation></semantics></math> of females, with the rest of the individuals being hermaphrodites. Hermaphrodites produce pollen, and so can contribute male gametes to females, other hermaphrodites, and themselves.</p>
<p>In this model <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Ψ</mo><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mover><mi>s</mi><mo accent="true">̃</mo></mover><mo>,</mo><mi>τ</mi><mo>,</mo><msub><mi>p</mi><mi>f</mi></msub><mo>,</mo><mi>σ</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Psi=\{\tilde{s},\tau,p_f,\sigma\}</annotation></semantics></math>. Here <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> is a composite parameter.</p>
<p>The following variables are estimated, with the field names given:</p>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>s</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{s}</annotation></semantics></math></td>
<td align="left">Selfing.s~</td>
<td align="left">Fraction of hermaphrodite seeds set by self-pollen.</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math></td>
<td align="left">Selfing.tau</td>
<td align="left">Relative viability of selfed seeds.</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>f</mi></msub><annotation encoding="application/x-tex">p_f</annotation></semantics></math></td>
<td align="left">Selfing.p_f</td>
<td align="left">The fraction of females</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></td>
<td align="left">Selfing.sigma</td>
<td align="left">The fraction of females</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math></td>
<td align="left">Selfing.s*</td>
<td align="left">Fraction of uniparental adults (selfing rate).</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>k</mi></msub><annotation encoding="application/x-tex">{T_k}</annotation></semantics></math></td>
<td align="left">Selfing.DiploidAFS.t!!k</td>
<td align="left">Number of generations of selfing for individual <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math></td>
<td align="left">Selfing.R</td>
<td align="left">Decrease in parent-sharing effective population size</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math></td>
<td align="left">Selfing.H</td>
<td align="left">Fraction of non-selfed individuals with a hermaphrodite seed-parent.</td>
</tr>
<tr class="odd">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>Θ</mo><mi>l</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">{\Theta^*_l}</annotation></semantics></math></td>
<td align="left">Selfing.Theta*!!l</td>
<td align="left"><em>Effective</em> scaled mutation rate for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</td>
</tr>
<tr class="even">
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>Θ</mo><mi>l</mi></msub><annotation encoding="application/x-tex">{\Theta_l}</annotation></semantics></math></td>
<td align="left">Selfing.Theta!!l</td>
<td align="left">Scaled mutation rate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mi>N</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">4Nu</annotation></semantics></math> for locus <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.</td>
</tr>
</tbody>
</table>
<p>Here the user must modify <code>Gyno.hs</code> to add additional information about 3 out of the 4 components of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>Ψ</mo><annotation encoding="application/x-tex">\Psi</annotation></semantics></math>.</p>
<p>This variant is run by specifying <code>-m Gyno.hs</code> on the command line.</p>
<h1 id="specifying-additional-information"><span class="header-section-number">8</span> Specifying additional information</h1>
<p>When the mating system parameters <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>Ψ</mo><annotation encoding="application/x-tex">\Psi</annotation></semantics></math> contain more than one degree of freedom, the mating system parameters are not identifiable from genetic data alone. Therefore, the user must obtain a model-description module (<code>HermID.hs</code>, <code>Andro.hs</code>, <code>AndroID.hs</code>, or <code>Gyno.hs</code>) and modify this module to add additional information to make the mating system parameters identifiable. In general, if <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>Ψ</mo><annotation encoding="application/x-tex">\Psi</annotation></semantics></math> contains <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> variables, then additional information about <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math> of them must be incorporated.</p>
<p>Additional information about a variable can be added in 3 ways.</p>
<ol style="list-style-type: decimal">
<li>Add observations that depends on that variable.</li>
<li>Fix the variable to a known constant value.</li>
<li>Place a subjective prior on the variable.</li>
</ol>
<h2 id="introduce-a-variable-with-a-prior-and-place-observations-on-it."><span class="header-section-number">8.1</span> Introduce a variable with a prior and place observations on it.</h2>
<pre><code>  tau &lt;- uniform 0.0 1.0;
  Observe 10 (binomial 20 tau);</code></pre>
<h2 id="fix-a-variable-to-a-known-constant-value."><span class="header-section-number">8.2</span> Fix a variable to a known constant value.</h2>
<p>If you know the value of a variable, you can fix it to a constant:</p>
<pre><code>  let {tau = 1.0};</code></pre>
<h2 id="place-a-subjective-prior-on-a-variable"><span class="header-section-number">8.3</span> Place a subjective prior on a variable</h2>
<p>This approach doesn't actually make the parameter <em>identifiable</em>, since this approach affects only the prior, and not the likelihood.</p>
<pre><code>  tau &lt;- beta 2.0 8.0;</code></pre>
<p>As a result, it is not possible to compare the posterior (with data) and the prior (without data) to assess the impact of the data. This approach is therefore not recommended.</p>
<h1 id="bayesian-priors-and-posteriors"><span class="header-section-number">9</span> Bayesian priors and posteriors</h1>
<p>In Bayesian parlance, <em>prior</em> means &quot;before the data&quot;, and <em>posterior</em> means &quot;after the data&quot;. The Bayesian approach places prior distributions on parameters. As a result, parameters become random variables, and can have distributions. This differs from the maximum likelihood setting, where parameters are not random. However, the researcher must interpret prior and posterior distributions carefully in order to avoid drawing erroneous conclusions.</p>
<h2 id="uninformative-priors"><span class="header-section-number">9.1</span> Uninformative priors</h2>
<p>We take the &quot;objective Bayesian&quot; approach, and seek priors that have minimal influence on the analysis. In general, such priors have a broad range. This range should not be characterized simply in terms of the mean or median, but in terms of the Bayesian Credible Interval (BCI), and in terms of the shapes of the tails of the distribution.</p>
<p>Note that, although the goal is to obtain priors with minimal influence, such priors are not actually &quot;uninformative&quot;. Specifically, a uniform prior is not &quot;uninformative&quot;. The choice of an appropriate prior should be undertaken with care in order to avoid ruling out any plausible outcome <em>a priori</em>.</p>
<h2 id="comparing-the-posterior-and-the-prior"><span class="header-section-number">9.2</span> Comparing the posterior and the prior</h2>
<p>The posterior distribution combines information the prior distribution and the likelihood. In order to determine if the shape of the posterior is being largely driven by the prior, or largely driven by the likelihood, one should compare the posterior and the prior distributions.</p>
<h2 id="priors-on-composite-parameters"><span class="header-section-number">9.3</span> Priors on composite parameters</h2>
<p>For models, such as the gynodioecious model, where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> is a composite parameter, no prior distribution is placed on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> directly. However, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> still has a prior distribution that is the combined result of the priors on all the basic parameters that it is computed from.</p>
<p>In order to determine what the shape of the prior on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mo>*</mo></msup><annotation encoding="application/x-tex">s^*</annotation></semantics></math> is, one can run the model without data. This can be done by commenting out the &quot;Observe&quot; statements.</p>
<h1 id="tasks"><span class="header-section-number">10</span> Tasks</h1>
<ol style="list-style-type: decimal">
<li>Run the Generic model to estimate s and thetas*.</li>
<li>Run the Herm model to estimate s and thetas and R.</li>
<li>Run the HermID model to estimate s and thetas and s~ and tau and R.</li>
<li>Run the Andro model to estimate s and thetas and p_m and R.</li>
<li>Run the AndroID model to estimate s and thetas and p_m and s~ and tau and R.</li>
<li>Run the Gyno model to estimate s and theta/theta* and s~ and tau and p_f and sigma and H and R.</li>
</ol>
</body>
</html>
